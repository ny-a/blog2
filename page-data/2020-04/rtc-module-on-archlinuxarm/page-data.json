{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2020-04/rtc-module-on-archlinuxarm/","result":{"data":{"site":{"siteMetadata":{"title":"Blog"}},"markdownRemark":{"id":"dbd52831-a222-5592-bf39-bae3a15592e4","excerpt":"ArchLinuxARM では簡単に RTC が有効化できた記憶があったのですが、再度試してみると\nうまくいかなかったのでいろいろ試してみました。 まず、前に設定して動いている Raspbian の  を見てみます。 このログの通り、  ができていて、時刻同期はスクリプトで行われます。 一方、ArchLinuxARM…","html":"<p>ArchLinuxARM では簡単に RTC が有効化できた記憶があったのですが、再度試してみると\nうまくいかなかったのでいろいろ試してみました。</p>\n<p>まず、前に設定して動いている Raspbian の <code class=\"language-text\">dmesg</code> を見てみます。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[    5.310771] rtc-ds1307 1-0068: registered as rtc0</code></pre></div>\n<p>このログの通り、 <code class=\"language-text\">/dev/rtc0</code> ができていて、時刻同期はスクリプトで行われます。</p>\n<p>一方、ArchLinuxARM だと以下のようなログが出ていました。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[    7.114025] hctosys: unable to open rtc device (rtc0\n...\n[    7.258978] i2c-bcm2835 3f805000.i2c: Could not read clock-frequency property</code></pre></div>\n<p><code class=\"language-text\">/dev/rtc0</code> も起動時は存在しない状態で、\n<code class=\"language-text\">echo &#39;ds1307 0x68&#39; | sudo tee /sys/bus/i2c/devices/i2c-1/new_device</code>\nを実行しないといけません。</p>\n<ul>\n<li><a href=\"https://archlinuxarm.org/forum/viewtopic.php?t=11802\">https://archlinuxarm.org/forum/viewtopic.php?t=11802</a></li>\n<li><a href=\"https://gist.github.com/Alex131089/de45d552372a9296abbbbe407ae52180\">https://gist.github.com/Alex131089/de45d552372a9296abbbbe407ae52180</a></li>\n<li><a href=\"https://raspberrypi.stackexchange.com/questions/38186/how-to-install-real-time-clock-rtc-on-raspbian\">https://raspberrypi.stackexchange.com/questions/38186/how-to-install-real-time-clock-rtc-on-raspbian</a></li>\n</ul>\n<p>上記のようなサイトをいくつか参照したのですが、ずばりの(？)解決策は\nなさそうです。よく考えたら Raspbian と違い aarch64 でした……</p>\n<p><code class=\"language-text\">hctosys</code> は <code class=\"language-text\">systemd</code> の起動前に(initramfs で)実行されているようです。\ninitramfs 内の udev に認識させればいけそうでしょうか。</p>","frontmatter":{"title":"RPi に aarch64 の ArchLinux を入れて RTC モジュールを有効化してみる","date":"April 09, 2020"}}},"pageContext":{"slug":"2020-04/rtc-module-on-archlinuxarm/","previous":{"fields":{"slug":"2020-04/dnssec-signature-expired-on-rpi/"},"frontmatter":{"title":"RPi 上の ArchLinuxArm での DNSSEC signature expired エラーの対処"}},"next":null}}}