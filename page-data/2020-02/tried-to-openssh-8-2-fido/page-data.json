{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2020-02/tried-to-openssh-8-2-fido/","result":{"data":{"site":{"siteMetadata":{"title":"Blog"}},"markdownRemark":{"id":"ce6bccf6-5da6-5d33-b4b8-c77df8b73a70","excerpt":"OpenSSH 8.2 がリリースされ、 fido2/u2f が公式にサポートされたようなので試してみました。 私は ArchLinux を使っているので比較的早くパッケージが降ってきます。\n具体的には、 2020-02-14 にリリースされ、当日中には\ntesting レポジトリに入り、 2020-02-16 0…","html":"<p>OpenSSH 8.2 がリリースされ、 fido2/u2f が公式にサポートされたようなので試してみました。</p>\n<p>私は ArchLinux を使っているので比較的早くパッケージが降ってきます。\n具体的には、 2020-02-14 にリリースされ、当日中には\ntesting レポジトリに入り、 2020-02-16 03:30Z に core レポジトリに入りました。\ncore に入ったことにより <code class=\"language-text\">pacman -Syu</code> でインストールできるようになったので試してみましょう。</p>\n<p><a href=\"https://www.openssh.com/txt/release-8.2\">OpenSSH 8.2 のリリースノート</a> を見ると、\n<code class=\"language-text\">ssh-keygen -t ecdsa-sk</code> で FIDO token backed key を生成することができるようですが、\n試してみると、</p>\n<div class=\"gatsby-highlight\" data-language=\"shellscript\"><pre class=\"language-shellscript\"><code class=\"language-shellscript\">$ ssh-keygen -t ecdsa-sk                                                                   :(\nGenerating public/private ecdsa-sk key pair.\nYou may need to touch your authenticator to authorize key generation.\nProvider &quot;&quot; dlsym(sk_api_version) failed: /usr/lib/ssh/ssh-sk-helper: undefined symbol: sk_api_version\nKey enrollment failed: invalid format</code></pre></div>\n<p>となり失敗します。</p>\n<p><a href=\"https://github.com/Yubico/libfido2/issues/116\">Yubico/libfido2 Issue#116</a>\nを見ると、 <code class=\"language-text\">ssh-keygen -t ecdsa-sk -w /usr/lib/libsk-libfido2.so</code> を実行すると以下のようなエラーが出ると書かれています。</p>\n<div class=\"gatsby-highlight\" data-language=\"shellscript\"><pre class=\"language-shellscript\"><code class=\"language-shellscript\">$ ssh-keygen -t ecdsa-sk -w /usr/lib/libsk-libfido2.so                                     :(\nGenerating public/private ecdsa-sk key pair.\nYou may need to touch your authenticator to authorize key generation.\nProvider &quot;/usr/lib/libsk-libfido2.so&quot; implements unsupported version 0x00020000 (supported: 0x00040000)\nKey enrollment failed: invalid format</code></pre></div>\n<p><a href=\"https://bugs.archlinux.org/task/65513\">FS#65513</a>\nにも書かれていますが、これは OpenSSH の configure 時に <code class=\"language-text\">--with-security-key-builtin</code> オプションを付けてビルドすると\n-w オプションなしで使えるようになるようです。\n上記でパッケージのバグとコメントされているので、数日中に直るでしょう。</p>\n<p>リビルドすれば試せますが、現状は Yubikey で間に合っているので降ってきたら試そうと思っています。</p>","frontmatter":{"title":"OpenSSH8.2でfido2/u2fを試そうとしました","date":"February 17, 2020"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"2020-02/tried-to-openssh-8-2-fido/","previous":{"fields":{"slug":"2020-02/git-rerere/"},"frontmatter":{"title":"Git rerereサブコマンドを知りました"}},"next":{"fields":{"slug":"2020-02/tried-openssh-8-2-fido/"},"frontmatter":{"title":"OpenSSH8.2でFIDO2を試しました"}}}}}