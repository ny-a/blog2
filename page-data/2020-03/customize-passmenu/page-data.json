{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2020-03/customize-passmenu/","result":{"data":{"site":{"siteMetadata":{"title":"Blog"}},"markdownRemark":{"id":"dbdc6073-66b2-5c52-8673-538a0fad8fec","excerpt":"パスワードマネージャーには Pass / password-store を使っていて、\nGUI 環境での入力には  を使っているのですが、 passmenu…","html":"<p>パスワードマネージャーには <a href=\"https://www.passwordstore.org/\">Pass / password-store</a> を使っていて、\nGUI 環境での入力には <code class=\"language-text\">passmenu</code> を使っているのですが、 passmenu のデフォルト動作は クリップボードへのコピーで、\n直接入力させるには <code class=\"language-text\">--type</code> オプションを付ける必要があり少し面倒だったので、動作をカスタマイズしてみました。</p>\n<p>オリジナルのソースは <a href=\"https://git.zx2c4.com/password-store/tree/contrib/dmenu/passmenu\">contrib/dmenu</a> にあります。\npass は全体がそうなのですが、中身はシンプルな bash スクリプトなので、好きなように修正してしまいます。</p>\n<div class=\"gatsby-highlight\" data-language=\"shellscript\"><pre class=\"language-shellscript\"><code class=\"language-shellscript\">#!/usr/bin/env bash\n\nshopt -s nullglob globstar\n\nline=1\nif [[ &quot;$1&quot; =~ ^[0-9]+$ ]]; then\n  line=$1\n  shift\nfi\n\nprefix=${PASSWORD_STORE_DIR-~/.password-store}\npassword_files=( &quot;$prefix&quot;/**/*.gpg )\npassword_files=( &quot;${password_files[@]#&quot;$prefix&quot;/}&quot; )\npassword_files=( &quot;${password_files[@]%.gpg}&quot; )\n\npassword=$(printf &#39;%s\\n&#39; &quot;${password_files[@]}&quot; | dmenu)\n\n[[ -n $password ]] || exit\n\npass $@ &quot;$password&quot; | tail -n+$line | head -n1 | tr -d &#39;\\n&#39; | xdotool type --clearmodifiers --file -</code></pre></div>\n<ul>\n<li>直接 type して欲しいときの方が多いのでデフォルト動作を type に変更\n(コピーしたかったら pass コマンドを使うので、というか直接 type させる以外する必要ない気が……)</li>\n<li>複数行に対応するため、1つめの引数が数字であればその行を出力するように変更</li>\n<li>otp なども入力できるように、以降の引数は dmenu ではなく pass に渡すように変更</li>\n</ul>\n<p>などをしました。</p>\n<p>dmenu にオプション渡してどうしたいんだろう……と思ってしまいました。 dmenu に慣れていないだけなんでしょうか？\nそれはともかく、パスワードを pass にがっつり依存してしまっているので、このスクリプトでかなり便利になりました。</p>\n<p>pass was written by Jason A. Donenfeld of zx2c4.com and is licensed under the <a href=\"http://www.gnu.org/licenses/gpl-2.0.html\">GPLv2</a>+</p>\n<p>contrib なのでライセンス違うような気もしますがそうでもない気もします。contrib だから違うってことはないか。はい。</p>","frontmatter":{"title":"passmenu をカスタマイズしてみました","date":"March 03, 2020"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"2020-03/customize-passmenu/","previous":{"fields":{"slug":"2020-03/scalajs-1-0-released/"},"frontmatter":{"title":"Scala.js 1.0 がリリースされました"}},"next":{"fields":{"slug":"2020-03/earlyoom-in-community-repo/"},"frontmatter":{"title":"earlyoomがcommunityレポジトリに入っていました"}}}}}